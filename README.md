# MyTop - 轻量级 Linux 交互式进程监控器

**MyTop** 是一个从零编写的 Linux 命令行进程监控工具（类 `top`/`htop`）
本项目不依赖 `ncurses` 等高级 TUI 库，而是通过直接解析 Linux `/proc` 伪文件系统，结合 ANSI 转义序列和 Termios 终端控制，实现了对系统资源和进程状态的实时监控与交互管理。
> 本项目为 **Linux 系统编程学习练手项目**。旨在通过“造轮子”的方式，深入理解 Linux `/proc` 文件系统、底层系统调用以及终端控制原理。代码存在很多不足，请多多包涵，如果有一些很致命的代码问题，可以指出，也让我能够学习。

## 核心功能

* **系统快照**：实时显示内核版本、机器架构及内存使用情况（Total/Free/Used/Buffers/Cached）。
* **CPU 计算**：基于 `/proc/stat` 时间片（Jiffies）差值，精确计算全局及单进程 CPU 使用率。
* **进程追踪**：遍历 `/proc/[pid]`，解析进程状态、内存占用（RSS）及命令行参数。
* **动态刷新**：采用双缓冲策略对比前后两帧数据，实现实时刷新。
* **交互控制**：
    * 支持按 **CPU**、**内存**、**PID** 动态排序。
    * 支持发送 `SIGTERM` 信号终止指定进程。
    * 非阻塞输入与 Raw Mode 终端控制。

## 快速开始

### 编译

项目包含标准的 `Makefile`，直接编译即可：

```bash
make
```

### 运行
```bash
make run
```

### 键盘控制

在程序运行时，支持以下快捷键：

| 按键 | 功能描述 |
|------|----------|
| q    | 退出程序 |
| c    | 按 CPU 使用率降序排序（默认） |
| m    | 按内存（RSS）使用率降序排序 |
| p    | 按 PID 升序排序 |
| k    | 进入杀进程模式（输入 PID 并确认） |

### 项目结构

```Plaintext
mytop/
├── include/
│   ├── mytop.h        # 核心业务接口
│   ├── mytop_types.h  # 数据结构定义
│   ├── utils.h        # 通用工具与终端控制
│   └── log.h          # 日志系统
├── src/
│   ├── main.c         # 程序入口与主循环 (Event Loop)
│   ├── system.c       # 系统与内存解析
│   ├── cpu.c          # CPU 使用率计算逻辑
│   ├── process.c      # 进程列表遍历与排序
│   ├── utils.c        # 通用工具函数
│   └── log.c          # 日志实现
└── Makefile           # 构建脚本
```

Author: Bdathe Date: 2026-01
